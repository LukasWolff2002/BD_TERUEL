<h1>Confirmar Exportación a Excel</h1>

<% if @variedades_por_dia.present? && @variedades_por_dia.any? %>
  <p>Se exportarán las siguientes variedades por día con sus precios por kilogramo:</p>

  <% @variedades_por_dia.each do |fecha, variedades| %>
    <h3>Fecha: <%= l(fecha, format: "%d/%m/%Y (%A)") %></h3>
    <table class="table">
      <thead>
        <tr>
          <th>Variedad</th>
          <th>Precio por Kilogramo (€)</th>
        </tr>
      </thead>
      <tbody>
        <% variedades.each do |variedad| %>
          <tr>
            <td><%= variedad[:variety] %></td>
            <td><%= number_to_currency(variedad[:price_per_kilogram], unit: "€") %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>

  <div class="mt-3">
    <!-- Botón para confirmar y exportar a Excel -->
    <%= link_to "Confirmar y Exportar a Excel", informe_receptions_path(
          fecha_inicio: @fecha_inicio,
          fecha_fin: @fecha_fin,
          supplier_id: @supplier_id,
          format: :xlsx
        ), class: "btn btn-success" %>

    <!-- Botón para cancelar y regresar -->
    <%= link_to "Cancelar", informe_receptions_path, class: "btn btn-secondary" %>
  </div>
<% else %>
  <div class="alert alert-warning">
    No se encontraron variedades para exportar con los filtros proporcionados.
  </div>
  <div class="mt-3">
    <%= link_to "Regresar al Informe", informe_receptions_path, class: "btn btn-primary" %>
  </div>
<% end %>