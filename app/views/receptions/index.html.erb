<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Recepciones</h1>
    <%= link_to 'Nueva Recepción', new_reception_path, class: 'btn btn-primary' %>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>Fecha</th>
          <th>Hora</th>
          <th>N° Guía</th>
          <th>Productos</th>
          <th>Pallets</th>
          <th>Cajas</th>
          <th>Kilos Totales</th>
          <th>Evaluador</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <% @receptions.each do |reception| %>
          <tr>
            <td><%= reception.fecha.strftime("%d/%m/%Y") %></td>
            <td><%= reception.hora.strftime("%H:%M") %></td>
            <td><%= reception.nro_guia_despacho %></td>
            <td>
              <% if reception.reception_items.present? %>
                <% reception.reception_items.each_with_index do |item, index| %>
                  <div>
                    <strong>Producto <%= index + 1 %>:</strong>
                    Sector: <%= item['sector'] %>,
                    Variedad: <%= item['variety'] %>,
                    Color: <%= item['color'] %>,
                    Firmeza: <%= item['firmeza'] %>,
                    Calidad: <%= item['calidad'] %>
                  </div>
                <% end %>
              <% else %>
                <em>No hay productos</em>
              <% end %>
            </td>
            <td><%= reception.pallets %></td>
            <td><%= reception.cajas %></td>
            <td><%= number_with_precision(reception.kilos_totales, precision: 2) %> kg</td>
            <td>
              <% if reception.user.present? %>
                <%= "#{reception.user.nombre} #{reception.user.apellido}" %>
              <% else %>
                <em>Sin evaluador</em>
              <% end %>
            </td>
            <td>
              <%= link_to reception_path(reception), class: "btn btn-sm btn-info me-1" do %>
                <i class="bi bi-eye"></i> Ver
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>